<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BlueRiot Syndicate</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">

    <style>
        :root {
            --neon-cyan: #00eaff;
            --neon-blue: #00C8FF;
            --neon-fuchsia: #ff4fd8;
            --bg-pure-dark: #050505;
            --bg-sidebar: #0a0d10;
            --bg-card: #0D1117;
            --text-primary: #FFFFFF;
            --text-secondary: #8B9DC3;
            --text-muted: #525866;
            --error: #FF4757;
            --success: #00FF88;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            overflow-x: hidden;
        }

        body {
            font-family: 'Share Tech Mono', monospace;
            background: var(--bg-pure-dark);
            color: var(--text-primary);
            min-height: 100vh;
            min-height: 100dvh;
            overflow-x: hidden;
        }

        /* ===== SCREENS ===== */
        .screen {
            display: none;
            min-height: 100vh;
            min-height: 100dvh;
        }
        .screen.active {
            display: flex;
        }

        /* ===== MAIN LAYOUT ===== */
        .app-container {
            display: flex;
            width: 100%;
            min-height: 100vh;
            min-height: 100dvh;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            width: 280px;
            min-width: 280px;
            background: var(--bg-sidebar);
            display: flex;
            flex-direction: column;
            padding: 32px 20px;
            border-right: 1px solid rgba(0, 234, 255, 0.1);
            position: relative;
            z-index: 100;
        }

        .sidebar-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
        }

        .logo-container {
            background: white;
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.3), 0 0 60px rgba(255, 255, 255, 0.1);
        }

        .blueriot-logo {
            width: 160px;
            height: auto;
            display: block;
        }

        .matrix-logo {
            width: 120px;
            height: auto;
            filter: drop-shadow(0 0 15px rgba(0, 234, 255, 0.6));
        }

        /* ===== NAV BUTTONS - RIGHT NEON 45¬∞ ===== */
        .nav-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
        }

        .nav-btn {
            position: relative;
            width: 100%;
            height: 52px;
            background: rgba(10, 14, 20, 0.95);
            border: none;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            font-size: 15px;
            font-weight: 700;
            letter-spacing: 2px;
            cursor: pointer;
            text-align: left;
            padding-left: 20px;
            transition: all 0.3s ease;
            clip-path: polygon(0 0, 100% 0, 100% 65%, 94% 100%, 0 100%);
        }

        .nav-btn::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            width: 4px;
            height: 50%;
            background: linear-gradient(180deg, var(--neon-cyan) 0%, var(--neon-cyan) 80%, transparent 100%);
            box-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan);
            transition: all 0.3s ease;
        }

        .nav-btn:hover::after,
        .nav-btn.active::after {
            background: linear-gradient(180deg, var(--neon-fuchsia) 0%, var(--neon-fuchsia) 80%, transparent 100%);
            box-shadow: 0 0 10px var(--neon-fuchsia), 0 0 20px var(--neon-fuchsia);
        }

        .nav-btn.active {
            background: rgba(255, 79, 216, 0.1);
        }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        /* Top neon line */
        .main-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--neon-cyan) 0%, var(--neon-cyan) 70%, transparent 100%);
            box-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan);
            z-index: 10;
        }

        .content-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            position: relative;
        }

        /* ===== LOGIN OPTIONS - LEFT NEON 45¬∞ ===== */
        .login-options {
            width: 100%;
            max-width: 420px;
        }

        .login-option {
            position: relative;
            background: rgba(10, 14, 20, 0.8);
            padding: 0;
            margin-bottom: 16px;
            clip-path: polygon(6% 0, 100% 0, 100% 100%, 0 100%, 0 35%);
            transition: all 0.3s ease;
        }

        .login-option::before {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 4px;
            height: 50%;
            background: linear-gradient(0deg, var(--neon-cyan) 0%, var(--neon-cyan) 80%, transparent 100%);
            box-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan);
            transition: all 0.3s ease;
            z-index: 2;
        }

        .login-option:hover::before,
        .login-option.active::before {
            background: linear-gradient(0deg, var(--neon-fuchsia) 0%, var(--neon-fuchsia) 80%, transparent 100%);
            box-shadow: 0 0 10px var(--neon-fuchsia), 0 0 20px var(--neon-fuchsia);
        }

        .login-option.active {
            background: rgba(255, 79, 216, 0.1);
        }

        .login-option-inner {
            padding: 20px 24px;
        }

        /* Google Button */
        .google-btn {
            width: 100%;
            height: 50px;
            background: white;
            color: #444;
            border: none;
            border-radius: 4px;
            font-family: 'Roboto', Arial, sans-serif;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.2s ease;
        }

        .google-btn:hover {
            background: #f5f5f5;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .google-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* Email Toggle */
        .email-toggle {
            width: 100%;
            height: 50px;
            background: transparent;
            border: 1px solid rgba(0, 234, 255, 0.3);
            color: var(--text-primary);
            border-radius: 4px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 15px;
            font-weight: 600;
            letter-spacing: 1px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .email-toggle:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 234, 255, 0.2);
        }

        .email-toggle.expanded {
            border-color: var(--neon-fuchsia);
        }

        .toggle-arrow {
            transition: transform 0.3s ease;
        }

        .toggle-arrow.rotated {
            transform: rotate(180deg);
        }

        /* Email Form */
        .email-form {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .email-form.expanded {
            max-height: 180px;
            margin-top: 16px;
        }

        .form-input {
            width: 100%;
            height: 46px;
            background: rgba(5, 5, 5, 0.9);
            border: 1px solid rgba(0, 234, 255, 0.2);
            border-radius: 4px;
            padding: 0 16px;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            font-size: 14px;
            margin-bottom: 12px;
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--neon-cyan);
            box-shadow: 0 0 10px rgba(0, 234, 255, 0.2);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .submit-btn {
            width: 100%;
            height: 46px;
            background: var(--neon-cyan);
            border: none;
            border-radius: 4px;
            color: #000;
            font-family: 'Share Tech Mono', monospace;
            font-size: 15px;
            font-weight: 700;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .submit-btn:hover {
            box-shadow: 0 0 20px rgba(0, 234, 255, 0.5);
        }

        .submit-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* Error Message */
        .error-msg {
            display: none;
            padding: 12px;
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid rgba(255, 71, 87, 0.3);
            border-radius: 4px;
            color: var(--error);
            font-size: 13px;
            margin-top: 16px;
        }

        .error-msg.show {
            display: block;
        }

        /* ===== MATRIX DASHBOARD ===== */
        .matrix-home {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 600px;
        }

        .matrix-logo-large {
            width: 200px;
            height: auto;
            filter: drop-shadow(0 0 20px rgba(0, 234, 255, 0.5));
            margin-bottom: 40px;
        }

        .matrix-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            color: var(--neon-cyan);
            text-shadow: 0 0 20px rgba(0, 234, 255, 0.5);
            margin-bottom: 10px;
            letter-spacing: 4px;
        }

        .matrix-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 40px;
        }

        /* ===== SECTION CARDS ===== */
        .section-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            width: 100%;
        }

        .section-card {
            position: relative;
            background: rgba(10, 14, 20, 0.9);
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            clip-path: polygon(0 0, 94% 0, 100% 35%, 100% 100%, 0 100%);
        }

        .section-card::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            width: 4px;
            height: 50%;
            background: linear-gradient(180deg, var(--neon-cyan) 0%, var(--neon-cyan) 80%, transparent 100%);
            box-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan);
            transition: all 0.3s ease;
        }

        .section-card:hover::after {
            background: linear-gradient(180deg, var(--neon-fuchsia) 0%, var(--neon-fuchsia) 80%, transparent 100%);
            box-shadow: 0 0 10px var(--neon-fuchsia), 0 0 20px var(--neon-fuchsia);
        }

        .section-card:hover {
            background: rgba(255, 79, 216, 0.1);
        }

        .section-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .section-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* ===== USER INFO ===== */
        .user-info {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(0, 234, 255, 0.1);
        }

        .user-email {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            word-break: break-all;
        }

        .logout-btn {
            width: 100%;
            height: 40px;
            background: transparent;
            border: 1px solid rgba(255, 71, 87, 0.3);
            color: var(--error);
            border-radius: 4px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .logout-btn:hover {
            background: rgba(255, 71, 87, 0.1);
            border-color: var(--error);
        }

        /* ===== HAMBURGER MENU (Mobile) ===== */
        .hamburger {
            display: none;
            position: fixed;
            top: 16px;
            left: 16px;
            z-index: 1000;
            width: 44px;
            height: 44px;
            background: var(--bg-sidebar);
            border: 1px solid rgba(0, 234, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .hamburger span {
            width: 22px;
            height: 2px;
            background: var(--neon-cyan);
            transition: all 0.3s ease;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 90;
        }

        .sidebar-overlay.active {
            display: block;
        }

        /* ===== DATABASE SCREENS ===== */
        .db-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: var(--bg-sidebar);
            border-bottom: 1px solid rgba(0, 234, 255, 0.1);
        }

        .db-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .add-btn {
            height: 42px;
            padding: 0 20px;
            background: var(--neon-cyan);
            border: none;
            border-radius: 4px;
            color: #000;
            font-family: 'Share Tech Mono', monospace;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .add-btn:hover {
            box-shadow: 0 0 15px rgba(0, 234, 255, 0.5);
        }

        .db-content {
            flex: 1;
            padding: 24px 30px;
            overflow-y: auto;
        }

        /* Filters */
        .filters {
            background: var(--bg-card);
            border: 1px solid rgba(0, 234, 255, 0.1);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
        }

        .filter-group label {
            display: block;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .filter-group input,
        .filter-group select {
            width: 100%;
            height: 40px;
            background: var(--bg-pure-dark);
            border: 1px solid rgba(0, 234, 255, 0.2);
            border-radius: 4px;
            padding: 0 12px;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            font-size: 13px;
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--neon-cyan);
        }

        /* Data Cards */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 16px;
        }

        .data-card {
            background: var(--bg-card);
            border: 1px solid rgba(0, 234, 255, 0.1);
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .data-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 234, 255, 0.2);
        }

        .data-card-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .data-card-meta {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .data-card-tag {
            display: inline-block;
            padding: 4px 10px;
            background: rgba(0, 234, 255, 0.1);
            border-radius: 4px;
            font-size: 11px;
            color: var(--neon-cyan);
            margin-right: 6px;
            margin-top: 8px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        /* ===== MODAL ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 5, 5, 0.95);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border: 1px solid rgba(0, 234, 255, 0.2);
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid rgba(0, 234, 255, 0.1);
        }

        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: rgba(255, 71, 87, 0.1);
            border-color: var(--error);
            color: var(--error);
        }

        .modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }

        .modal-form-group {
            margin-bottom: 16px;
        }

        .modal-form-group label {
            display: block;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .modal-form-group input,
        .modal-form-group select,
        .modal-form-group textarea {
            width: 100%;
            background: var(--bg-pure-dark);
            border: 1px solid rgba(0, 234, 255, 0.2);
            border-radius: 4px;
            padding: 12px;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            font-size: 14px;
        }

        .modal-form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            padding: 20px 24px;
            border-top: 1px solid rgba(0, 234, 255, 0.1);
        }

        .modal-actions button {
            flex: 1;
            height: 44px;
            border-radius: 4px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-cancel {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-secondary);
        }

        .btn-cancel:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .btn-save {
            background: var(--neon-cyan);
            border: none;
            color: #000;
        }

        .btn-save:hover {
            box-shadow: 0 0 15px rgba(0, 234, 255, 0.5);
        }

        /* ===== MOBILE RESPONSIVE ===== */
        @media (max-width: 768px) {
            .hamburger {
                display: flex;
            }

            .sidebar {
                position: fixed;
                left: -300px;
                top: 0;
                height: 100%;
                transition: left 0.3s ease;
            }

            .sidebar.open {
                left: 0;
            }

            .main-content {
                width: 100%;
            }

            .content-area {
                padding: 80px 20px 20px;
            }

            .section-grid {
                grid-template-columns: 1fr;
            }

            .db-header {
                padding: 70px 20px 20px;
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .db-content {
                padding: 20px;
            }

            .data-grid {
                grid-template-columns: 1fr;
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ===== LOADING ===== */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(0, 234, 255, 0.2);
            border-top-color: var(--neon-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 12px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Hamburger Menu -->
    <button class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- ==================== LOGIN SCREEN ==================== -->
    <div id="loginScreen" class="screen active">
        <div class="app-container">
            <aside class="sidebar" id="loginSidebar">
                <div class="sidebar-header">
                    <div class="logo-container">
                        <img src="blueriot-logo.png" alt="BlueRiot Syndicate" class="blueriot-logo">
                    </div>
                    <img src="matrix.png" alt="Matrix" class="matrix-logo">
                </div>

                <nav class="nav-buttons">
                    <button class="nav-btn active" data-lang="it">IT</button>
                    <button class="nav-btn" data-lang="en">EN</button>
                    <button class="nav-btn" data-lang="es">ES</button>
                    <button class="nav-btn" data-lang="de">DE</button>
                    <button class="nav-btn" data-lang="fr">FR</button>
                </nav>
            </aside>

            <main class="main-content">
                <div class="content-area">
                    <div class="login-options">
                        <!-- Google Login -->
                        <div class="login-option" id="googleOption">
                            <div class="login-option-inner">
                                <button class="google-btn" id="googleBtn">
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"/>
                                        <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
                                        <path fill="#FBBC05" d="M3.964 10.707c-.18-.54-.282-1.117-.282-1.707s.102-1.17.282-1.709V4.958H.957C.347 6.173 0 7.548 0 9s.348 2.827.957 4.042l3.007-2.335z"/>
                                        <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z"/>
                                    </svg>
                                    Sign in with Google
                                </button>
                            </div>
                        </div>

                        <!-- Email Login -->
                        <div class="login-option" id="emailOption">
                            <div class="login-option-inner">
                                <button class="email-toggle" id="emailToggle">
                                    <span class="toggle-arrow" id="toggleArrow">‚ñº</span>
                                    EMAIL LOGIN
                                </button>

                                <div class="email-form" id="emailForm">
                                    <input type="email" id="emailInput" class="form-input" placeholder="email@example.com">
                                    <input type="password" id="passwordInput" class="form-input" placeholder="Password">
                                    <button class="submit-btn" id="emailSubmit">ACCEDI</button>
                                </div>
                            </div>
                            <div class="error-msg" id="errorMsg"></div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ==================== MATRIX DASHBOARD ==================== -->
    <div id="matrixScreen" class="screen">
        <div class="app-container">
            <aside class="sidebar" id="matrixSidebar">
                <div class="sidebar-header">
                    <div class="logo-container">
                        <img src="blueriot-logo.png" alt="BlueRiot Syndicate" class="blueriot-logo">
                    </div>
                    <img src="matrix.png" alt="Matrix" class="matrix-logo">
                </div>

                <nav class="nav-buttons" id="mainNav">
                    <button class="nav-btn active" data-section="home">mŒ±trŒπœá</button>
                    <button class="nav-btn" data-section="tastes">Œ§ŒîSŒ§Œû5</button>
                    <button class="nav-btn" data-section="routes">R0UT35</button>
                    <button class="nav-btn" data-section="stay">SŒ§ŒîŒ•</button>
                    <button class="nav-btn" data-section="node">NODŒû</button>
                </nav>

                <div class="user-info">
                    <div class="user-email" id="userEmail"></div>
                    <button class="logout-btn" id="logoutBtn">LOGOUT</button>
                </div>
            </aside>

            <main class="main-content">
                <!-- HOME -->
                <div class="content-area" id="homeContent">
                    <div class="matrix-home">
                        <img src="matrix.png" alt="Matrix" class="matrix-logo-large">
                        <h1 class="matrix-title">mŒ±trŒπœá</h1>
                        <p class="matrix-subtitle">Seleziona un servizio per iniziare</p>

                        <div class="section-grid">
                            <div class="section-card" data-goto="tastes">
                                <div class="section-icon">üçΩÔ∏è</div>
                                <div class="section-title">Œ§ŒîSŒ§Œû5</div>
                                <div class="section-desc">Database ristoranti, bar, gelaterie e locali testati</div>
                            </div>
                            <div class="section-card" data-goto="routes">
                                <div class="section-icon">üöå</div>
                                <div class="section-title">R0UT35</div>
                                <div class="section-desc">Database trasporti: bus, treni, ferry, taxi, NCC</div>
                            </div>
                            <div class="section-card" data-goto="stay">
                                <div class="section-icon">üè®</div>
                                <div class="section-title">SŒ§ŒîŒ•</div>
                                <div class="section-desc">Database hotel alternativi, B&B e strutture</div>
                            </div>
                            <div class="section-card" data-goto="node">
                                <div class="section-icon">‚ö°</div>
                                <div class="section-title">NODŒû</div>
                                <div class="section-desc">eTickets, PDF OCR, gestione tour completa</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TASTES -->
                <div id="tastesContent" style="display:none; flex-direction:column; flex:1;">
                    <div class="db-header">
                        <h1 class="db-title">üçΩÔ∏è Œ§ŒîSŒ§Œû5 - Database Locali</h1>
                        <button class="add-btn" id="addTasteBtn">+ Aggiungi Locale</button>
                    </div>
                    <div class="db-content">
                        <div class="filters">
                            <div class="filters-grid">
                                <div class="filter-group">
                                    <label>Citt√†</label>
                                    <input type="text" id="filterTasteCity" placeholder="es. Roma">
                                </div>
                                <div class="filter-group">
                                    <label>Tipo Cucina</label>
                                    <input type="text" id="filterTasteCuisine" placeholder="es. Italiana">
                                </div>
                                <div class="filter-group">
                                    <label>Vantaggi TL</label>
                                    <select id="filterTasteAdvantage">
                                        <option value="">Tutti</option>
                                        <option value="sconto">Sconto</option>
                                        <option value="omaggio">Omaggio</option>
                                        <option value="priorita">Priorit√†</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div id="tastesList" class="data-grid">
                            <div class="empty-state">
                                <div class="empty-state-icon">üçΩÔ∏è</div>
                                <p>Nessun locale trovato. Aggiungi il primo!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ROUTES -->
                <div id="routesContent" style="display:none; flex-direction:column; flex:1;">
                    <div class="db-header">
                        <h1 class="db-title">üöå R0UT35 - Database Trasporti</h1>
                        <button class="add-btn" id="addRouteBtn">+ Aggiungi Tratta</button>
                    </div>
                    <div class="db-content">
                        <div class="filters">
                            <div class="filters-grid">
                                <div class="filter-group">
                                    <label>Partenza</label>
                                    <input type="text" id="filterRouteFrom" placeholder="es. Roma">
                                </div>
                                <div class="filter-group">
                                    <label>Arrivo</label>
                                    <input type="text" id="filterRouteTo" placeholder="es. Firenze">
                                </div>
                                <div class="filter-group">
                                    <label>Tipo</label>
                                    <select id="filterRouteType">
                                        <option value="">Tutti</option>
                                        <option value="bus">Bus</option>
                                        <option value="treno">Treno</option>
                                        <option value="ferry">Ferry</option>
                                        <option value="taxi">Taxi/NCC</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div id="routesList" class="data-grid">
                            <div class="empty-state">
                                <div class="empty-state-icon">üöå</div>
                                <p>Nessuna tratta trovata. Aggiungi la prima!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- STAY -->
                <div id="stayContent" style="display:none; flex-direction:column; flex:1;">
                    <div class="db-header">
                        <h1 class="db-title">üè® SŒ§ŒîŒ• - Database Hotel</h1>
                        <button class="add-btn" id="addStayBtn">+ Aggiungi Struttura</button>
                    </div>
                    <div class="db-content">
                        <div class="filters">
                            <div class="filters-grid">
                                <div class="filter-group">
                                    <label>Citt√†</label>
                                    <input type="text" id="filterStayCity" placeholder="es. Firenze">
                                </div>
                                <div class="filter-group">
                                    <label>Tipo</label>
                                    <select id="filterStayType">
                                        <option value="">Tutti</option>
                                        <option value="hotel">Hotel</option>
                                        <option value="bb">B&B</option>
                                        <option value="appartamento">Appartamento</option>
                                        <option value="ostello">Ostello</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div id="stayList" class="data-grid">
                            <div class="empty-state">
                                <div class="empty-state-icon">üè®</div>
                                <p>Nessuna struttura trovata. Aggiungi la prima!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NODE -->
                <div id="nodeContent" style="display:none; flex-direction:column; flex:1;">
                    <div class="db-header">
                        <h1 class="db-title">‚ö° NODŒû - Gestione Tour</h1>
                    </div>
                    <div class="db-content">
                        <div class="section-grid" style="max-width: 600px;">
                            <div class="section-card" id="eticketCard">
                                <div class="section-icon">üé´</div>
                                <div class="section-title">eTickets</div>
                                <div class="section-desc">Importa e gestisci biglietti elettronici</div>
                            </div>
                            <div class="section-card" id="pdfOcrCard">
                                <div class="section-icon">üìÑ</div>
                                <div class="section-title">PDF OCR</div>
                                <div class="section-desc">Estrai dati da documenti PDF</div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ==================== MODALS ==================== -->
    <!-- Taste Modal -->
    <div class="modal" id="tasteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Aggiungi Locale</h2>
                <button class="modal-close" id="closeTasteModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-form-group">
                    <label>Nome Locale *</label>
                    <input type="text" id="tasteName" placeholder="es. Ristorante Da Mario">
                </div>
                <div class="modal-form-group">
                    <label>Citt√† *</label>
                    <input type="text" id="tasteCity" placeholder="es. Roma">
                </div>
                <div class="modal-form-group">
                    <label>Tipo Cucina</label>
                    <input type="text" id="tasteCuisine" placeholder="es. Italiana, Pizza, Pesce">
                </div>
                <div class="modal-form-group">
                    <label>Indirizzo</label>
                    <input type="text" id="tasteAddress" placeholder="es. Via Roma 123">
                </div>
                <div class="modal-form-group">
                    <label>Telefono</label>
                    <input type="text" id="tastePhone" placeholder="es. +39 06 1234567">
                </div>
                <div class="modal-form-group">
                    <label>Note</label>
                    <textarea id="tasteNotes" placeholder="Vantaggi TL, orari, info utili..."></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" id="cancelTaste">Annulla</button>
                <button class="btn-save" id="saveTaste">Salva</button>
            </div>
        </div>
    </div>

    <!-- Route Modal -->
    <div class="modal" id="routeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Aggiungi Tratta</h2>
                <button class="modal-close" id="closeRouteModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-form-group">
                    <label>Partenza *</label>
                    <input type="text" id="routeFrom" placeholder="es. Roma Termini">
                </div>
                <div class="modal-form-group">
                    <label>Arrivo *</label>
                    <input type="text" id="routeTo" placeholder="es. Firenze SMN">
                </div>
                <div class="modal-form-group">
                    <label>Tipo Trasporto *</label>
                    <select id="routeType">
                        <option value="bus">Bus</option>
                        <option value="treno">Treno</option>
                        <option value="ferry">Ferry</option>
                        <option value="taxi">Taxi/NCC</option>
                    </select>
                </div>
                <div class="modal-form-group">
                    <label>Compagnia</label>
                    <input type="text" id="routeCompany" placeholder="es. Trenitalia, Flixbus">
                </div>
                <div class="modal-form-group">
                    <label>Durata</label>
                    <input type="text" id="routeDuration" placeholder="es. 1h 30min">
                </div>
                <div class="modal-form-group">
                    <label>Prezzo Indicativo</label>
                    <input type="text" id="routePrice" placeholder="es. ‚Ç¨15-25">
                </div>
                <div class="modal-form-group">
                    <label>Note</label>
                    <textarea id="routeNotes" placeholder="Frequenza, affidabilit√†, tips..."></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" id="cancelRoute">Annulla</button>
                <button class="btn-save" id="saveRoute">Salva</button>
            </div>
        </div>
    </div>

    <!-- Stay Modal -->
    <div class="modal" id="stayModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Aggiungi Struttura</h2>
                <button class="modal-close" id="closeStayModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-form-group">
                    <label>Nome Struttura *</label>
                    <input type="text" id="stayName" placeholder="es. Hotel Bella Vista">
                </div>
                <div class="modal-form-group">
                    <label>Citt√† *</label>
                    <input type="text" id="stayCity" placeholder="es. Firenze">
                </div>
                <div class="modal-form-group">
                    <label>Tipo *</label>
                    <select id="stayType">
                        <option value="hotel">Hotel</option>
                        <option value="bb">B&B</option>
                        <option value="appartamento">Appartamento</option>
                        <option value="ostello">Ostello</option>
                    </select>
                </div>
                <div class="modal-form-group">
                    <label>Indirizzo</label>
                    <input type="text" id="stayAddress" placeholder="es. Via Firenze 45">
                </div>
                <div class="modal-form-group">
                    <label>Prezzo/Notte</label>
                    <input type="text" id="stayPrice" placeholder="es. ‚Ç¨60-90">
                </div>
                <div class="modal-form-group">
                    <label>Contatto</label>
                    <input type="text" id="stayContact" placeholder="es. +39 055 1234567">
                </div>
                <div class="modal-form-group">
                    <label>Note</label>
                    <textarea id="stayNotes" placeholder="Commissioni, convenzioni, tips..."></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" id="cancelStay">Annulla</button>
                <button class="btn-save" id="saveStay">Salva</button>
            </div>
        </div>
    </div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // ===== CONFIG =====
        const SUPABASE_URL = 'https://kvomxtzcnczvbcscybcy.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_WgMzf0xMBQ6a8WMcun3fvg_sUfBQ8qC';

        let db = null;
        let currentUser = null;

        // Init Supabase
        try {
            db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            console.log('‚úÖ Supabase ready');
        } catch (e) {
            console.error('‚ùå Supabase error:', e);
        }

        // ===== DOM =====
        const $ = id => document.getElementById(id);
        const $$ = sel => document.querySelectorAll(sel);

        // Screens
        const loginScreen = $('loginScreen');
        const matrixScreen = $('matrixScreen');

        // Login elements
        const googleBtn = $('googleBtn');
        const googleOption = $('googleOption');
        const emailToggle = $('emailToggle');
        const emailForm = $('emailForm');
        const toggleArrow = $('toggleArrow');
        const emailOption = $('emailOption');
        const emailInput = $('emailInput');
        const passwordInput = $('passwordInput');
        const emailSubmit = $('emailSubmit');
        const errorMsg = $('errorMsg');

        // Dashboard elements
        const userEmailEl = $('userEmail');
        const logoutBtn = $('logoutBtn');
        const mainNav = $('mainNav');

        // Content areas
        const homeContent = $('homeContent');
        const tastesContent = $('tastesContent');
        const routesContent = $('routesContent');
        const stayContent = $('stayContent');
        const nodeContent = $('nodeContent');

        // Mobile
        const hamburger = $('hamburger');
        const sidebarOverlay = $('sidebarOverlay');
        const loginSidebar = $('loginSidebar');
        const matrixSidebar = $('matrixSidebar');

        // ===== HELPERS =====
        function showScreen(screen) {
            $$('.screen').forEach(s => s.classList.remove('active'));
            screen.classList.add('active');
        }

        function showError(msg) {
            errorMsg.textContent = msg;
            errorMsg.classList.add('show');
            setTimeout(() => errorMsg.classList.remove('show'), 5000);
        }

        function showSection(section) {
            // Hide all content
            homeContent.style.display = 'none';
            tastesContent.style.display = 'none';
            routesContent.style.display = 'none';
            stayContent.style.display = 'none';
            nodeContent.style.display = 'none';

            // Update nav
            $$('#mainNav .nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`#mainNav .nav-btn[data-section="${section}"]`)?.classList.add('active');

            // Show selected
            switch(section) {
                case 'home':
                    homeContent.style.display = 'flex';
                    break;
                case 'tastes':
                    tastesContent.style.display = 'flex';
                    loadTastes();
                    break;
                case 'routes':
                    routesContent.style.display = 'flex';
                    loadRoutes();
                    break;
                case 'stay':
                    stayContent.style.display = 'flex';
                    loadStay();
                    break;
                case 'node':
                    nodeContent.style.display = 'flex';
                    break;
            }

            // Close mobile sidebar
            closeSidebar();
        }

        function closeSidebar() {
            hamburger.classList.remove('active');
            loginSidebar.classList.remove('open');
            matrixSidebar.classList.remove('open');
            sidebarOverlay.classList.remove('active');
        }

        // ===== AUTH =====
        // Google login
        googleBtn.addEventListener('click', async () => {
            if (!db) return showError('Database non disponibile');

            googleOption.classList.add('active');
            googleBtn.disabled = true;
            googleBtn.textContent = 'Reindirizzamento...';

            try {
                const { error } = await db.auth.signInWithOAuth({
                    provider: 'google',
                    options: { redirectTo: window.location.origin + window.location.pathname }
                });
                if (error) throw error;
            } catch (e) {
                showError(e.message || 'Errore login Google');
                googleBtn.disabled = false;
                googleBtn.innerHTML = `<svg width="18" height="18" viewBox="0 0 18 18"><path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"/><path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/><path fill="#FBBC05" d="M3.964 10.707c-.18-.54-.282-1.117-.282-1.707s.102-1.17.282-1.709V4.958H.957C.347 6.173 0 7.548 0 9s.348 2.827.957 4.042l3.007-2.335z"/><path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z"/></svg> Sign in with Google`;
                googleOption.classList.remove('active');
            }
        });

        // Email toggle
        let emailExpanded = false;
        emailToggle.addEventListener('click', () => {
            emailExpanded = !emailExpanded;
            emailForm.classList.toggle('expanded', emailExpanded);
            toggleArrow.classList.toggle('rotated', emailExpanded);
            emailOption.classList.toggle('active', emailExpanded);
        });

        // Email login
        emailSubmit.addEventListener('click', async () => {
            const email = emailInput.value.trim();
            const password = passwordInput.value;

            if (!email || !password) return showError('Inserisci email e password');
            if (!db) return showError('Database non disponibile');

            emailSubmit.disabled = true;
            emailSubmit.textContent = 'ACCESSO...';

            try {
                const { error } = await db.auth.signInWithPassword({ email, password });
                if (error) throw error;
            } catch (e) {
                showError(e.message || 'Errore login');
                emailSubmit.disabled = false;
                emailSubmit.textContent = 'ACCEDI';
            }
        });

        // Logout
        logoutBtn.addEventListener('click', async () => {
            if (db) await db.auth.signOut();
            currentUser = null;
            showScreen(loginScreen);
        });

        // Auth state
        if (db) {
            db.auth.onAuthStateChange((event, session) => {
                console.log('Auth:', event);
                if (event === 'SIGNED_IN' && session) {
                    currentUser = session.user;
                    userEmailEl.textContent = session.user.email;
                    showScreen(matrixScreen);
                    showSection('home');
                } else if (event === 'SIGNED_OUT') {
                    currentUser = null;
                    showScreen(loginScreen);
                }
            });

            // Check session
            db.auth.getSession().then(({ data: { session } }) => {
                if (session) {
                    currentUser = session.user;
                    userEmailEl.textContent = session.user.email;
                    showScreen(matrixScreen);
                    showSection('home');
                }
            });
        }

        // ===== NAVIGATION =====
        // Language buttons
        $$('#loginScreen .nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                $$('#loginScreen .nav-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });

        // Main nav
        mainNav.addEventListener('click', e => {
            const btn = e.target.closest('.nav-btn');
            if (btn) showSection(btn.dataset.section);
        });

        // Section cards
        $$('.section-card[data-goto]').forEach(card => {
            card.addEventListener('click', () => showSection(card.dataset.goto));
        });

        // ===== MOBILE =====
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            const isLogin = loginScreen.classList.contains('active');
            const sidebar = isLogin ? loginSidebar : matrixSidebar;
            sidebar.classList.toggle('open');
            sidebarOverlay.classList.toggle('active');
        });

        sidebarOverlay.addEventListener('click', closeSidebar);

        // ===== DATA LOADING =====
        async function loadTastes() {
            if (!db) return;
            const list = $('tastesList');
            list.innerHTML = '<div class="loading"><div class="spinner"></div>Caricamento...</div>';

            try {
                const { data, error } = await db.from('tastes').select('*').order('created_at', { ascending: false });
                if (error) throw error;

                if (!data || data.length === 0) {
                    list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üçΩÔ∏è</div><p>Nessun locale trovato. Aggiungi il primo!</p></div>';
                    return;
                }

                list.innerHTML = data.map(item => `
                    <div class="data-card">
                        <div class="data-card-title">${item.name || 'Senza nome'}</div>
                        <div class="data-card-meta">
                            üìç ${item.city || 'N/A'}<br>
                            üçΩÔ∏è ${item.cuisine || 'N/A'}
                        </div>
                        ${item.advantages ? `<span class="data-card-tag">${item.advantages}</span>` : ''}
                    </div>
                `).join('');
            } catch (e) {
                console.error('Load tastes error:', e);
                list.innerHTML = '<div class="empty-state"><p>Errore caricamento dati</p></div>';
            }
        }

        async function loadRoutes() {
            if (!db) return;
            const list = $('routesList');
            list.innerHTML = '<div class="loading"><div class="spinner"></div>Caricamento...</div>';

            try {
                const { data, error } = await db.from('routes').select('*').order('created_at', { ascending: false });
                if (error) throw error;

                if (!data || data.length === 0) {
                    list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üöå</div><p>Nessuna tratta trovata. Aggiungi la prima!</p></div>';
                    return;
                }

                list.innerHTML = data.map(item => `
                    <div class="data-card">
                        <div class="data-card-title">${item.from_location || '?'} ‚Üí ${item.to_location || '?'}</div>
                        <div class="data-card-meta">
                            üöå ${item.type || 'N/A'}<br>
                            ‚è±Ô∏è ${item.duration || 'N/A'} | üí∞ ${item.price || 'N/A'}
                        </div>
                        ${item.company ? `<span class="data-card-tag">${item.company}</span>` : ''}
                    </div>
                `).join('');
            } catch (e) {
                console.error('Load routes error:', e);
                list.innerHTML = '<div class="empty-state"><p>Errore caricamento dati</p></div>';
            }
        }

        async function loadStay() {
            if (!db) return;
            const list = $('stayList');
            list.innerHTML = '<div class="loading"><div class="spinner"></div>Caricamento...</div>';

            try {
                const { data, error } = await db.from('stay').select('*').order('created_at', { ascending: false });
                if (error) throw error;

                if (!data || data.length === 0) {
                    list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üè®</div><p>Nessuna struttura trovata. Aggiungi la prima!</p></div>';
                    return;
                }

                list.innerHTML = data.map(item => `
                    <div class="data-card">
                        <div class="data-card-title">${item.name || 'Senza nome'}</div>
                        <div class="data-card-meta">
                            üìç ${item.city || 'N/A'}<br>
                            üè® ${item.type || 'N/A'} | üí∞ ${item.price || 'N/A'}
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                console.error('Load stay error:', e);
                list.innerHTML = '<div class="empty-state"><p>Errore caricamento dati</p></div>';
            }
        }

        // ===== MODALS =====
        // Taste Modal
        $('addTasteBtn').addEventListener('click', () => $('tasteModal').classList.add('active'));
        $('closeTasteModal').addEventListener('click', () => $('tasteModal').classList.remove('active'));
        $('cancelTaste').addEventListener('click', () => $('tasteModal').classList.remove('active'));
        $('saveTaste').addEventListener('click', async () => {
            if (!db) return;
            const data = {
                name: $('tasteName').value,
                city: $('tasteCity').value,
                cuisine: $('tasteCuisine').value,
                address: $('tasteAddress').value,
                phone: $('tastePhone').value,
                notes: $('tasteNotes').value
            };
            if (!data.name || !data.city) return alert('Nome e Citt√† obbligatori');

            try {
                const { error } = await db.from('tastes').insert([data]);
                if (error) throw error;
                $('tasteModal').classList.remove('active');
                loadTastes();
            } catch (e) {
                alert('Errore salvataggio: ' + e.message);
            }
        });

        // Route Modal
        $('addRouteBtn').addEventListener('click', () => $('routeModal').classList.add('active'));
        $('closeRouteModal').addEventListener('click', () => $('routeModal').classList.remove('active'));
        $('cancelRoute').addEventListener('click', () => $('routeModal').classList.remove('active'));
        $('saveRoute').addEventListener('click', async () => {
            if (!db) return;
            const data = {
                from_location: $('routeFrom').value,
                to_location: $('routeTo').value,
                type: $('routeType').value,
                company: $('routeCompany').value,
                duration: $('routeDuration').value,
                price: $('routePrice').value,
                notes: $('routeNotes').value
            };
            if (!data.from_location || !data.to_location) return alert('Partenza e Arrivo obbligatori');

            try {
                const { error } = await db.from('routes').insert([data]);
                if (error) throw error;
                $('routeModal').classList.remove('active');
                loadRoutes();
            } catch (e) {
                alert('Errore salvataggio: ' + e.message);
            }
        });

        // Stay Modal
        $('addStayBtn').addEventListener('click', () => $('stayModal').classList.add('active'));
        $('closeStayModal').addEventListener('click', () => $('stayModal').classList.remove('active'));
        $('cancelStay').addEventListener('click', () => $('stayModal').classList.remove('active'));
        $('saveStay').addEventListener('click', async () => {
            if (!db) return;
            const data = {
                name: $('stayName').value,
                city: $('stayCity').value,
                type: $('stayType').value,
                address: $('stayAddress').value,
                price: $('stayPrice').value,
                contact: $('stayContact').value,
                notes: $('stayNotes').value
            };
            if (!data.name || !data.city) return alert('Nome e Citt√† obbligatori');

            try {
                const { error } = await db.from('stay').insert([data]);
                if (error) throw error;
                $('stayModal').classList.remove('active');
                loadStay();
            } catch (e) {
                alert('Errore salvataggio: ' + e.message);
            }
        });

        console.log('üöÄ BlueRiot Matrix Ready');
    </script>
</body>
</html>
